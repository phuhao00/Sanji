# 贡献指南

感谢您对Sanji游戏引擎的兴趣！我们欢迎所有形式的贡献。

## 🤝 如何贡献

### 报告Bug

在报告Bug之前，请：
1. 搜索现有的issue，确保问题未被报告过
2. 使用最新版本测试问题是否仍然存在
3. 收集相关信息（操作系统、Rust版本等）

创建Bug报告时，请包括：
- 问题的详细描述
- 复现步骤
- 预期行为和实际行为
- 系统信息和引擎版本
- 相关的错误信息或日志

### 功能建议

我们欢迎功能建议！请：
1. 在issue中详细描述建议的功能
2. 解释为什么这个功能有用
3. 如果可能，提供设计草图或伪代码

### 代码贡献

#### 开发环境设置

1. Fork这个仓库
2. 创建分支：`git checkout -b feature/your-feature-name`
3. 安装依赖：`cargo build`
4. 进行更改
5. 运行测试：`cargo test`
6. 运行示例确保工作正常：`cargo run --example basic_demo`

#### 代码规范

- 使用`cargo fmt`格式化代码
- 运行`cargo clippy`进行代码检查
- 为公共API添加文档注释
- 编写测试用例
- 遵循现有的代码风格

#### 提交消息格式

使用清晰的提交消息：

```
类型: 简短描述

详细描述（如有必要）

- 修复了什么问题
- 添加了什么功能
- 可能的影响
```

类型可以是：
- `feat`: 新功能
- `fix`: Bug修复
- `docs`: 文档更新
- `style`: 代码格式调整
- `refactor`: 代码重构
- `test`: 测试相关
- `chore`: 构建或工具相关

#### Pull Request流程

1. 确保所有测试通过
2. 更新相关文档
3. 在PR中描述所做的更改
4. 请求代码审查
5. 根据反馈进行调整

## 🏗️ 开发指南

### 项目结构

```
sanji_engine/
├── src/              # 主要源代码
│   ├── core/         # 核心引擎功能
│   ├── render/       # 渲染系统
│   ├── ecs/         # 实体组件系统
│   ├── scene/       # 场景管理
│   ├── assets/      # 资源管理
│   ├── input/       # 输入处理
│   ├── math/        # 数学工具
│   ├── events/      # 事件系统
│   └── time/        # 时间管理
├── examples/         # 示例程序
└── docs/            # 文档
```

### 编码规范

#### Rust代码风格

- 使用4个空格缩进
- 行长度限制为100字符
- 变量和函数名使用snake_case
- 类型名使用PascalCase
- 常量使用SCREAMING_SNAKE_CASE

#### 文档规范

- 所有public函数都需要文档注释
- 使用中文编写文档（项目面向中文用户）
- 包含使用示例
- 标注错误情况

```rust
/// 创建新的渲染器实例
/// 
/// # 参数
/// 
/// * `config` - 渲染配置
/// 
/// # 返回
/// 
/// 成功时返回渲染器实例，失败时返回错误
/// 
/// # 示例
/// 
/// ```rust
/// let renderer = Renderer::new(config)?;
/// ```
/// 
/// # 错误
/// 
/// 当无法初始化图形设备时返回 `RenderError`
pub fn new(config: RenderConfig) -> EngineResult<Self> {
    // 实现
}
```

### 测试

#### 单元测试
- 为所有public函数编写测试
- 测试边界情况和错误情况
- 使用描述性的测试名称

```rust
#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_create_renderer_with_valid_config() {
        // 测试正常情况
    }

    #[test]
    fn test_create_renderer_with_invalid_config() {
        // 测试错误情况
    }
}
```

#### 集成测试
- 在`tests/`目录中创建集成测试
- 测试模块间的交互
- 测试完整的使用流程

### 性能考虑

- 避免不必要的内存分配
- 使用适当的数据结构
- 考虑多线程安全性
- 进行性能基准测试

### 依赖管理

- 谨慎添加新依赖
- 优先选择维护良好的crate
- 考虑编译时间和二进制大小
- 使用feature标志控制可选依赖

## 📋 开发清单

提交PR前请确认：

- [ ] 代码通过`cargo fmt`格式化
- [ ] 代码通过`cargo clippy`检查
- [ ] 所有测试通过`cargo test`
- [ ] 示例程序运行正常
- [ ] 添加了适当的文档
- [ ] 更新了CHANGELOG.md（如适用）

## 🎯 优先级任务

当前急需贡献的领域：

- **文档完善** - 教程和API文档
- **示例程序** - 更多使用示例
- **性能优化** - 渲染和ECS性能
- **平台兼容性** - 不同操作系统测试
- **错误处理** - 更好的错误报告

## 💬 沟通

- GitHub Issues - Bug报告和功能建议
- GitHub Discussions - 一般讨论和问题
- 代码审查 - 通过PR进行技术讨论

## 🙏 感谢

感谢所有贡献者的付出，让Sanji引擎不断改进！

---

**记住：好的代码是写给人看的，顺便能被机器执行。** 📚✨
